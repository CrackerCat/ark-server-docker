version: '3'

services:
  ark:
    user: "${U_ID}:${G_ID}"
    hostname: ARK_SVC
    container_name: ARK_SVC
    build:
      context: .
      dockerfile: ./Dockerfile
    environment:
      - TZ=Asia/Shanghai
      - LANG=zh_CN.UTF-8
      - LANGUAGE=zh_CN.UTF-8
      - LC_ALL=zh_CN.UTF-8
    volumes:
      - ./volumes/steam/saved:/home/steam/saved
      - ./volumes/steam/games:/home/steam/games
    ports:
      # Port for connections from ARK game client
      - "7777:7777/udp"
      # Raw UDP socket port (always Game client port +1)  : 自定义的服务器端口
      - "7778:7778/udp"
      # RCON management port: 服务器命令行管理工具 RCON 的连接端口
      - "27020:27020/tcp"
      # Steam's server-list port
      - "27015:27015/udp"
    networks: 
      ark:
        ipv4_address: 172.168.3.2
    restart: on-failure

    # 服务端端口
# GAME_CLIENT_PORT=7777
# # 暴露给玩家连接主机的端口（总是 GAME_CLIENT_PORT + 1）
# UDP_SOCKET_PORT=7778
# 暴露给 Steam 用于搜索服务时的端口
# SERVER_LIST_PORT=27015
# 服务端命令行管理工具 RCON 的连接端口
RCON_PORT=32330


networks:
  ark:
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet:  172.168.3.0/24
          gateway: 172.168.3.1


